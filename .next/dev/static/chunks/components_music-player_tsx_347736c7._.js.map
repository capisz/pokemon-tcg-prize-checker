{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/admin/Desktop/projects/pokemon-tcg-prize-checker/components/music-player.tsx"],"sourcesContent":["\"use client\"\n\nimport {\n  createContext,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n  type ReactNode,\n  type ChangeEvent,\n} from \"react\"\nimport { Volume2, VolumeX, Pause, Play } from \"lucide-react\"\n\ntype MusicContextValue = {\n  volume: number\n  muted: boolean\n  playing: boolean\n  setVolume: (v: number) => void\n  toggleMute: () => void\n  togglePlay: () => void\n}\n\nconst MusicContext = createContext<MusicContextValue | null>(null)\n\n// Make sure this file exists at public/audio/bg-music.mp3\nconst MUSIC_SRC = \"/audio/bg-music.mp3\"\n\nexport function MusicProvider({ children }: { children: ReactNode }) {\n  const audioRef = useRef<HTMLAudioElement | null>(null)\n  const [playing, setPlaying] = useState(false)\n  const [volume, setVolumeState] = useState(0.35)\n  const [muted, setMuted] = useState(false)\n\n  // Initial setup + first autoplay attempt\n  useEffect(() => {\n    const el = audioRef.current\n    if (!el) return\n\n    el.loop = true\n    el.volume = volume\n\n    el\n      .play()\n      .then(() => {\n        setPlaying(true)\n      })\n      .catch(() => {\n        // Autoplay blocked; we'll try again on first interaction\n        setPlaying(false)\n      })\n  }, [])\n\n  // Fallback: start playing on first user interaction (any click/tap)\n  useEffect(() => {\n    const handleFirstInteraction = () => {\n      const el = audioRef.current\n      if (!el) return\n\n      el\n        .play()\n        .then(() => setPlaying(true))\n        .catch(() => {\n          // If still blocked, no crash – user can try again\n        })\n    }\n\n    window.addEventListener(\"pointerdown\", handleFirstInteraction, {\n      once: true,\n    })\n\n    return () => {\n      window.removeEventListener(\"pointerdown\", handleFirstInteraction)\n    }\n  }, [])\n\n  const setVolume = (v: number) => {\n    const clamped = Math.max(0, Math.min(1, v))\n    setVolumeState(clamped)\n    if (audioRef.current) {\n      audioRef.current.volume = clamped\n      if (clamped === 0) {\n        setMuted(true)\n        audioRef.current.muted = true\n      } else {\n        setMuted(false)\n        audioRef.current.muted = false\n      }\n    }\n  }\n\n  const toggleMute = () => {\n    setMuted((prev) => {\n      const next = !prev\n      if (audioRef.current) {\n        audioRef.current.muted = next\n      }\n      return next\n    })\n  }\n\n  const togglePlay = () => {\n    const el = audioRef.current\n    if (!el) return\n\n    if (playing) {\n      el.pause()\n      setPlaying(false)\n    } else {\n      el\n        .play()\n        .then(() => setPlaying(true))\n        .catch(() => {\n          // Still blocked, but that's fine – no crash\n        })\n    }\n  }\n\n  return (\n    <MusicContext.Provider\n      value={{\n        volume,\n        muted,\n        playing,\n        setVolume,\n        toggleMute,\n        togglePlay,\n      }}\n    >\n      {/* Hidden audio element that everything controls */}\n      <audio ref={audioRef} src={MUSIC_SRC} />\n      {children}\n    </MusicContext.Provider>\n  )\n}\n\nexport function useMusic() {\n  const ctx = useContext(MusicContext)\n  if (!ctx) {\n    throw new Error(\"useMusic must be used within a MusicProvider\")\n  }\n  return ctx\n}\n\n/* ---------- Footer controls (unused now, but kept in case you want later) ---------- */\n\nexport function FooterMusicControls() {\n  const { volume, muted, setVolume, toggleMute, playing, togglePlay } =\n    useMusic()\n\n  const handleSliderChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const value = Number(e.target.value)\n    setVolume(value / 100)\n  }\n\n  return (\n    <div className=\"flex items-center gap-2 rounded-full bg-emerald-900/80 px-3 py-1 shadow-sm shadow-emerald-500/30\">\n      {/* Play / pause */}\n      <button\n        type=\"button\"\n        onClick={togglePlay}\n        className=\"flex h-7 w-7 items-center justify-center rounded-full bg-emerald-500 text-slate-950 hover:bg-emerald-400 transition\"\n        aria-label={playing ? \"Pause music\" : \"Play music\"}\n      >\n        {playing ? <Pause className=\"h-3 w-3\" /> : <Play className=\"h-3 w-3\" />}\n      </button>\n\n      {/* Mute */}\n      <button\n        type=\"button\"\n        onClick={toggleMute}\n        className=\"text-emerald-100 hover:text-emerald-300 transition\"\n        aria-label={muted ? \"Unmute\" : \"Mute\"}\n      >\n        {muted || volume === 0 ? (\n          <VolumeX className=\"h-4 w-4\" />\n        ) : (\n          <Volume2 className=\"h-4 w-4\" />\n        )}\n      </button>\n\n      {/* Volume slider */}\n      <input\n        type=\"range\"\n        min={0}\n        max={100}\n        value={muted ? 0 : Math.round(volume * 100)}\n        onChange={handleSliderChange}\n        className=\"h-1 w-20 cursor-pointer accent-emerald-400\"\n      />\n    </div>\n  )\n}\n\n/* ---------- Floating in-game vertical slider ---------- */\n\nexport function FloatingGameVolume() {\n  const { volume, setVolume, muted, toggleMute } = useMusic()\n\n  const handleSliderChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const value = Number(e.target.value)\n    setVolume(value / 100)\n  }\n\n  const sliderValue = muted ? 0 : Math.round(volume * 100)\n\n  return (\n    <div className=\"fixed bottom-24 right-4 z-40 flex flex-col items-center gap-2 rounded-2xl border border-emerald-500/40 bg-slate-900/95 px-3 py-3 shadow-lg shadow-emerald-500/30 backdrop-blur\">\n      {/* Mute / unmute icon */}\n      <button\n        type=\"button\"\n        onClick={toggleMute}\n        className=\"text-emerald-200 hover:text-emerald-400 transition\"\n        aria-label={muted ? \"Unmute\" : \"Mute\"}\n      >\n        {muted || sliderValue === 0 ? (\n          <VolumeX className=\"h-4 w-4\" />\n        ) : (\n          <Volume2 className=\"h-4 w-4\" />\n        )}\n      </button>\n\n      {/* Vertical slider */}\n      <div className=\"h-24 flex items-center\">\n        <input\n          type=\"range\"\n          min={0}\n          max={100}\n          value={sliderValue}\n          onChange={handleSliderChange}\n          className=\"w-24 h-1 origin-center -rotate-90 cursor-pointer accent-emerald-400\"\n        />\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}